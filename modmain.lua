----------------------------------------------------
----------------- 注册Prefab文件 -------------------

PrefabFiles = {
    --人物
    "hutao_none",
    "hutao",

    --武器
	

    --采集物
    

    --食物和调味料
    
    
    --食物有关的buff
    

    --其它物品
    

    --蓝图
    

    --技能召唤物
    

    --特效
    
}

----------------------------------------------------
------------------ 图片资源文件 --------------------

Assets = {
    --动作
    

    --其它物品
    

--------------------------------------------------------------------
    --制作
    Asset( "IMAGE", "images/inventoryimages/book_firepit.tex" ),
    Asset( "ATLAS", "images/inventoryimages/book_firepit.xml" ),

    Asset( "IMAGE", "images/inventoryimages/book_cookpot.tex" ),
    Asset( "ATLAS", "images/inventoryimages/book_cookpot.xml" ),

    Asset( "IMAGE", "images/inventoryimages/book_spicer.tex" ),
    Asset( "ATLAS", "images/inventoryimages/book_spicer.xml" ),

    Asset( "IMAGE", "images/inventoryimages/amakumo_fruit.tex" ),
    Asset( "ATLAS", "images/inventoryimages/amakumo_fruit.xml" ),

    Asset( "IMAGE", "images/inventoryimages/ako_sake_vessel.tex" ),
    Asset( "ATLAS", "images/inventoryimages/ako_sake_vessel.xml" ),

    Asset( "IMAGE", "images/inventoryimages/crown_of_insight.tex" ),
    Asset( "ATLAS", "images/inventoryimages/crown_of_insight.xml" ),

--------------------------------------------------------------------
    --小地图
    

--------------------------------------------------------------------
    --声音
    

--------------------------------------------------------------------
    --
    Asset( "IMAGE", "images/saveslot_portraits/raiden_shogun.tex" ),
    Asset( "ATLAS", "images/saveslot_portraits/raiden_shogun.xml" ),

    Asset( "IMAGE", "images/selectscreen_portraits/raiden_shogun.tex" ),
    Asset( "ATLAS", "images/selectscreen_portraits/raiden_shogun.xml" ),
	
    Asset( "IMAGE", "images/selectscreen_portraits/raiden_shogun_silho.tex" ),
    Asset( "ATLAS", "images/selectscreen_portraits/raiden_shogun_silho.xml" ),

    Asset( "IMAGE", "bigportraits/raiden_shogun.tex" ),
    Asset( "ATLAS", "bigportraits/raiden_shogun.xml" ),
	
	Asset( "IMAGE", "images/map_icons/raiden_shogun.tex" ),
	Asset( "ATLAS", "images/map_icons/raiden_shogun.xml" ),
	
	Asset( "IMAGE", "images/avatars/avatar_raiden_shogun.tex" ),
    Asset( "ATLAS", "images/avatars/avatar_raiden_shogun.xml" ),
	
	Asset( "IMAGE", "images/avatars/avatar_ghost_raiden_shogun.tex" ),
    Asset( "ATLAS", "images/avatars/avatar_ghost_raiden_shogun.xml" ),

    Asset( "IMAGE", "images/avatars/self_inspect_raiden_shogun.tex" ), 
    Asset( "ATLAS", "images/avatars/self_inspect_raiden_shogun.xml" ),
	
	Asset( "IMAGE", "bigportraits/raiden_shogun_none.tex" ),
    Asset( "ATLAS", "bigportraits/raiden_shogun_none.xml" ),
	
	Asset( "IMAGE", "images/names_raiden_shogun.tex" ),
    Asset( "ATLAS", "images/names_raiden_shogun.xml" ),
---------------------------------------------------------------
--有关技能图标
    Asset( "IMAGE", "images/ui/eleskill_hutao.tex" ),
    Asset( "ATLAS", "images/ui/eleskill_hutao.xml" ),

    Asset( "ANIM", "anim/eleburst_hutao.zip" ),

---------------------------------------------------------------
--命之座图片
    Asset( "IMAGE", "images/ui/constellation_hutao/1_enable.tex" ),
    Asset( "ATLAS", "images/ui/constellation_hutao/1_enable.xml" ),
    Asset( "IMAGE", "images/ui/constellation_hutao/1_disable.tex" ),
    Asset( "ATLAS", "images/ui/constellation_hutao/1_disable.xml" ),

    Asset( "IMAGE", "images/ui/constellation_hutao/2_enable.tex" ),
    Asset( "ATLAS", "images/ui/constellation_hutao/2_enable.xml" ),
    Asset( "IMAGE", "images/ui/constellation_hutao/2_disable.tex" ),
    Asset( "ATLAS", "images/ui/constellation_hutao/2_disable.xml" ),

    Asset( "IMAGE", "images/ui/constellation_hutao/3_enable.tex" ),
    Asset( "ATLAS", "images/ui/constellation_hutao/3_enable.xml" ),
    Asset( "IMAGE", "images/ui/constellation_hutao/3_disable.tex" ),
    Asset( "ATLAS", "images/ui/constellation_hutao/3_disable.xml" ),

    Asset( "IMAGE", "images/ui/constellation_hutao/4_enable.tex" ),
    Asset( "ATLAS", "images/ui/constellation_hutao/4_enable.xml" ),
    Asset( "IMAGE", "images/ui/constellation_hutao/4_disable.tex" ),
    Asset( "ATLAS", "images/ui/constellation_hutao/4_disable.xml" ),

    Asset( "IMAGE", "images/ui/constellation_hutao/5_enable.tex" ),
    Asset( "ATLAS", "images/ui/constellation_hutao/5_enable.xml" ),
    Asset( "IMAGE", "images/ui/constellation_hutao/5_disable.tex" ),
    Asset( "ATLAS", "images/ui/constellation_hutao/5_disable.xml" ),

    Asset( "IMAGE", "images/ui/constellation_hutao/6_enable.tex" ),
    Asset( "ATLAS", "images/ui/constellation_hutao/6_enable.xml" ),
    Asset( "IMAGE", "images/ui/constellation_hutao/6_disable.tex" ),
    Asset( "ATLAS", "images/ui/constellation_hutao/6_disable.xml" ),

    Asset( "IMAGE", "images/ui/constellation_hutao/constellation_image.tex" ),
    Asset( "ATLAS", "images/ui/constellation_hutao/constellation_image.xml" ),

    Asset( "IMAGE", "images/ui/constellation_hutao/constellation_lines.tex" ),
    Asset( "ATLAS", "images/ui/constellation_hutao/constellation_lines.xml" ),

--天赋图片
    Asset( "IMAGE", "images/ui/talents_hutao/talent_icon_1.tex" ),
    Asset( "ATLAS", "images/ui/talents_hutao/talent_icon_1.xml" ),

    Asset( "IMAGE", "images/ui/talents_hutao/talent_icon_2.tex" ),
    Asset( "ATLAS", "images/ui/talents_hutao/talent_icon_2.xml" ),

    Asset( "IMAGE", "images/ui/talents_hutao/talent_icon_3.tex" ),
    Asset( "ATLAS", "images/ui/talents_hutao/talent_icon_3.xml" ),

    Asset( "IMAGE", "images/ui/talents_hutao/talent_icon_4.tex" ),
    Asset( "ATLAS", "images/ui/talents_hutao/talent_icon_4.xml" ),

    Asset( "IMAGE", "images/ui/talents_hutao/talent_icon_5.tex" ),
    Asset( "ATLAS", "images/ui/talents_hutao/talent_icon_5.xml" ),

    Asset( "IMAGE", "images/ui/talents_hutao/talent_icon_6.tex" ),
    Asset( "ATLAS", "images/ui/talents_hutao/talent_icon_6.xml" ),
}

----------------------------------------------------
GLOBAL.setmetatable(env,{__index=function(t,k) return GLOBAL.rawget(GLOBAL,k) end})
--------------------- 自定义 -----------------------

TUNING.ELEMENTALBURST_KEY = GetModConfigData("key_elementalburst")

TUNING.ELEMENTALSKILL_KEY = GetModConfigData("key_elementalskill")

TUNING.LANGUAGE_GENSHIN_HUTAO = TUNING.LANGUAGE_GENSHIN_CORE

TUNING.HUTAO_UISCALE = TUNING.GENSHINCORE_UISCALE or 1

----------------------------------------------------
---------------------- 常量 ------------------------
--武器参数

-- TUNING.ENGULFINGLIGHTNING_DAMAGE = 51
-- TUNING.ENGULFINGLIGHTNING_ATKUP_RATE = { 0.28, 0.35, 0.42, 0.49, 0.56 }
-- TUNING.ENGULFINGLIGHTNING_ATKUP_MAX = { 0.8, 0.9, 1, 1.1, 1.2 }
-- TUNING.ENGULFINGLIGHTNING_RECHARGEUP = { 0.3, 0.35, 0.4, 0.45, 0.5 }

-- TUNING.FAVONIUSLANCE_DAMAGE = 37
-- TUNING.FAVONIUSLANCE_EFFECT_CD = { 12, 10.5, 9, 7.5, 6 }
-- TUNING.FAVONIUSLANCE_TRIGGER_RATE = { 0.6, 0.7, 0.8, 0.9, 1 }

-- TUNING.THECATCH_DAMAGE = 44
-- TUNING.THCATCH_CRIT_RATE = { 0.06, 0.075, 0.09, 0.105, 0.12 }
-- TUNING.THECATCH_ELEBURST_BONUS = { 0.16, 0.2, 0.24, 0.28, 0.32 }

--------------------------------------
--人物参数
TUNING.HUTAO_BASEATK = 5

TUNING.HUTAO_HEALTH = 225
TUNING.HUTAO_HUNGER = 150
TUNING.HUTAO_SANITY = 150

--------------------------------------
--厨艺经验

--------------------------------------
--食物BUFF参数


--------------------------------------
--植物参数
-- TUNING.AMAKUMO_GRASS_REGROW_TIME = TUNING.TOTAL_DAY_TIME * 4  --长出来的时间
-- TUNING.AMAKUMOGRASS_REGROWTH_TIME = TUNING.TOTAL_DAY_TIME * 6  --资源再生时间（被烧掉），这两个是不一样的

------------------------------------------
--技能参数
TUNING.HUTAOSKILL_NORMALATK = 
{
    --LEVEL            1      2      3      4      5      6      7      8      9      10     11     12     13     14     15
    ATK_DMG =        {0.627, 0.670, 0.712, 0.769, 0.812, 0.862, 0.926, 0.990, 1.054, 1.119, 1.183, 1.247, 1.311, 1.375, 1.439},
    CHARGE_ATK_DMG = {1.360, 1.452, 1.545, 1.669, 1.761, 1.869, 2.009, 2.148, 2.287, 2.426, 2.565, 2.704, 2.843, 2.982, 3.121},
}

TUNING.HUTAOSKILL_ELESKILL = 
{
    CD = 16,
    DURATION = 9,
    HP_COST = 0.3,
    BLD_BLSM_DURATION = 8,
    --LEVEL           1      2      3      4      5      6      7      8      9      10     11     12     13     14     15
    BLD_BLSM_DMG =   {0.640, 0.688, 0.736, 0.800, 0.848, 0.896, 0.960, 1.024, 1.088, 1.152, 1.216, 1.280, 1.360, 1.440, 1.520},
    ATK_INCREASE =   {0.0384,0.0407,0.043, 0.046, 0.0483,0.0506,0.0536,0.0566,0.0596,0.0626,0.0656,0.0685,0.0715,0.0745,0.0775},
}

TUNING.HUTAOSKILL_ELEBURST = 
{
    CD = 15,
    ENERGY = 60,
    --LEVEL              1      2      3      4      5      6      7      8      9      10     11     12     13     14     15
    DMG =               {3.033, 3.214, 3.396, 3.632, 3.814, 3.995, 4.231, 4.467, 4.703, 4.940, 5.176, 5.412, 5.648, 5.884, 6.120},
    LOWHP_DMG =         {3.791, 4.018, 4.245, 4.540, 4.767, 4.994, 5.289, 5.584, 5.879, 6.174, 6.470, 6.765, 7.060, 7.355, 7.650},
    REGENERATION =      {0.0626,0.0664,0.0701,0.0750,0.0787,0.0825,0.0874,0.0922,0.0971,0.1020,0.1069,0.1117,0.1166,0.1215,0.1264},
    LOWHP_REGENERATION ={0.0835,0.0885,0.0935,0.1000,0.1050,0.1100,0.1165,0.1230,0.1295,0.1360,0.1425,0.1490,0.1555,0.1620,0.1685},
}

TUNING.HUTAO_AREASKILLS_NOTAGS = {"FX", "NOCLICK", "DECOR", "INLIMBO", "player", "playerghost", "companion", "abigail"}

TUNING.HUTAOSKILL_NORMALATK_SORT = 
{
    "ATK_DMG",
    "CHARGE_ATK_DMG",
}

TUNING.HUTAOSKILL_ELESKILL_SORT = 
{
    "HP_COST",
    "ATK_INCREASE",
    "BLD_BLSM_DMG",
    "BLD_BLSM_DURATION",
    "DURATION",
    "CD",
}

TUNING.HUTAOSKILL_ELEBURST_SORT = 
{
    "DMG",
    "LOWHP_DMG",
    "REGENERATION",
    "LOWHP_REGENERATION",
    "CD",
    "ENERGY",
}

------------------------------------------

TUNING.HUTAO_CONSTELLATION_POSITION = 
{
    {0, -312},
    {264, -150},
    {264, 110},
    {0, 280},
    {-264, 110},
    {-264, -155},
}

require("recipe")
TUNING.HUTAO_TALENTS_INGREDIENTS = 
{
    {--[[Ingredient("amakumo_fruit", 2, "images/inventoryimages/amakumo_fruit.xml"),]] Ingredient("redgem", 1), Ingredient("goldnugget", 1)},  --1~2
    {--[[Ingredient("amakumo_fruit", 4, "images/inventoryimages/amakumo_fruit.xml"),]] Ingredient("redgem", 1), Ingredient("goldnugget", 2)},  --2~3
    {--[[Ingredient("amakumo_fruit", 6, "images/inventoryimages/amakumo_fruit.xml"),]] Ingredient("redgem", 2), Ingredient("goldnugget", 3)},  --3~4
    {--[[Ingredient("amakumo_fruit", 8, "images/inventoryimages/amakumo_fruit.xml"),]] Ingredient("redgem", 2), Ingredient("goldnugget", 4)},  --4~5
    {--[[Ingredient("amakumo_fruit", 10, "images/inventoryimages/amakumo_fruit.xml"),]] Ingredient("redgem", 3), Ingredient("goldnugget", 5)},  --5~6
    {--[[Ingredient("amakumo_fruit", 12, "images/inventoryimages/amakumo_fruit.xml"),]] Ingredient("redgem", 3), Ingredient("goldnugget", 6)},  --6~7
    {--[[Ingredient("amakumo_fruit", 15, "images/inventoryimages/amakumo_fruit.xml"),]] Ingredient("redgem", 4), Ingredient("goldnugget", 7)},  --7~8
    {--[[Ingredient("amakumo_fruit", 20, "images/inventoryimages/amakumo_fruit.xml"),]] Ingredient("redgem", 4), Ingredient("goldnugget", 8)},  --8~9
    {--[[Ingredient("amakumo_fruit", 30, "images/inventoryimages/amakumo_fruit.xml"),]] Ingredient("redgem", 5), Ingredient("goldnugget", 9), Ingredient("crown_of_insight", 1, "images/inventoryimages/crown_of_insight.xml")},  --9~10
}

-- table.insert(TUNING.POLEARM_WEAPONS, "thecatch")
-- table.insert(TUNING.POLEARM_WEAPONS, "favoniuslance")
-- table.insert(TUNING.POLEARM_WEAPONS, "engulfinglightning")

----------------------------------------------------
----------------------  ------------------------
--暂时禁用这个排查，不知道是什么问题呢
--modimport("editedanim.lua")

----------------------------------------------------
---------------------- 描述 ------------------------

modimport("scripts/import/hutao_descriptions.lua")

----------------------------------------------------
---------------------- 制作 ------------------------

modimport("scripts/import/genshin_hutao_recipes.lua")

----------------------------------------------------
----------------------- UI -------------------------

modimport("scripts/import/hutaoui_postconstruct.lua")

----------------------------------------------------
---------------------- 动作 -------------------------

-- modimport("scripts/import/action_raiden_cookbook.lua")

----------------------------------------------------
----------------------- SG -------------------------

-- modimport("scripts/import/raiden_sg.lua")

modimport("scripts/import/eventhandler_yawn_postinit")

----------------------------------------------------
----------------------- 料理 -------------------------

-- local raiden_foods = require("import/raiden_preparedfoods")
-- for k, recipe in pairs (raiden_foods) do
-- 	AddCookerRecipe("cookpot", recipe, true)
-- 	AddCookerRecipe("portablecookpot", recipe, true)
-- 	AddCookerRecipe("archive_cookpot", recipe, true)
-- end

----------------------------------------------------
---------------------- 修改 -------------------------

-- modimport("scripts/import/cook_postinit.lua")

modimport("scripts/import/cursable_postinit.lua")

-- modimport("scripts/import/regrowthmanager_postinit.lua")

-- modimport("scripts/import/moonbase_postinit.lua")

modimport("scripts/import/crownloot_prefabpostinit.lua")

--------------------------------------

--客机组件
-- require "entityreplica"
-- AddReplicableComponent("cookunlocker")

--------------------------------------------------------------------------
--初始物品
-- TUNING.GAMEMODE_STARTING_ITEMS.DEFAULT.HUTAO = {  }
-- TUNING.STARTING_ITEM_IMAGE_OVERRIDE.favoniuslance = { atlas = , image =  }

STRINGS.CHARACTER_SURVIVABILITY.hutao = TUNING.LANGUAGE_GENSHIN_HUTAO == "sc" and "不那么难" or "Not that Hard"

--------------------------------------------------------------------------
--物品图标
-- AddMinimapAtlas("images/map_icons/amakumo_grass.xml")

--------------------------------------------------------------------------
--添加角色
AddMinimapAtlas("images/map_icons/raiden_shogun.xml")

AddModCharacter("hutao", "FEMALE")

-----------------------------------------------------------------------
-----------------------------Bug Tracker-------------------------------

bugtracker_config = {
	email = "diaokedu17430@126.com",
	upload_client_log = true,
	upload_server_log = true,
	-- 其它配置项目...
}
